services:
  # SQL Server Database
  sqlserver:
    image: mcr.microsoft.com/mssql/server:2022-latest
    container_name: hcm-sqlserver
    hostname: sqlserver
    environment:
      ACCEPT_EULA: Y
      SA_PASSWORD: YourStrong@Passw0rd
      MSSQL_PID: Express
    ports:
      - '1433:1433'
    volumes:
      - sqlserver_data:/var/opt/mssql
      - ./scripts/sql:/scripts
    networks:
      - hcm-network
    restart: unless-stopped
    healthcheck:
      test: ['CMD-SHELL', "/opt/mssql-tools18/bin/sqlcmd -S localhost -U sa -P YourStrong@Passw0rd -C -Q 'SELECT 1' || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 30s

  # Application (optional - uncomment when ready)
  # app:
  #   build:
  #     context: .
  #     dockerfile: Dockerfile
  #   container_name: hcm-app
  #   environment:
  #     - APP_DATABASE_DRIVER=sqlserver
  #     - APP_DATABASE_DSN=sqlserver://sa:YourStrong@Passw0rd@sqlserver:1433?database=hcmdb&encrypt=disable&trustServerCertificate=true
  #     - APP_SERVER_HOST=0.0.0.0
  #     - APP_SERVER_PORT=8080
  #   ports:
  #     - "8080:8080"
  #   depends_on:
  #     sqlserver:
  #       condition: service_healthy
  #   networks:
  #     - hcm-network
  #   restart: unless-stopped

volumes:
  sqlserver_data:
    driver: local

networks:
  hcm-network:
    driver: bridge
